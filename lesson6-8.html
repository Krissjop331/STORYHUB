<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>STORYHUB - –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫—É—Ä—Å–∞</title>
    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/slick.css" />
    <link rel="stylesheet" href="css/jquery.fancybox.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/style.css" />
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="js/test-export.js"></script>
    <link rel="stylesheet" href="css/header-ui.css" />
</head>

  <body>
    <script src="js/site-guard-header.js"></script>
    <header class="header sg-header">
  <div class="container">
    <div class="header_inner">
      <a href="lesson0.html" class="logo">STORY<span>HUB</span></a>
      <div class="header-controls">
        <a href="#" class="admin-panel-btn" id="adminPanelBtn" style="display:none" title="–ü–∞–Ω–µ–ª—å">–ê–¥–º–∏–Ω–∫–∞</a>
        <div class="exit">
          <p class="nameuser" id="userName"></p>
          <a href="#" class="iconexit" id="logoutBtn" title="–í—ã–π—Ç–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã">–í—ã–π—Ç–∏</a>
        </div>
      </div>
    </div>
  </div>
</header>

    <div class="content">
      <div class="container">
        <div class="content_inner">
          <div class="menu">
            <div class="class-switch">
              <button class="switch-btn active" data-href="lesson1.html">
                5 –∫–ª–∞—Å—Å
              </button>
              <button class="switch-btn" data-href="2lesson.html">
                6 –∫–ª–∞—Å—Å
              </button>
            </div>
            <ul class="lesson-list">
              <li data-href="lesson0.html">–í–≤–µ–¥–µ–Ω–∏–µ</li>
              <li data-href="lesson1.html">
                –£—Ä–æ–∫ 1. –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ –∫–∞–±–∏–Ω–µ—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∏
              </li>
              <li data-href="lesson2.html">–£—Ä–æ–∫ 2. –≠—Ä–≥–æ–Ω–æ–º–∏–∫–∞</li>
              <li data-href="lesson3.html">
                –£—Ä–æ–∫ 3. –ö–∏–±–µ—Ä-–≥–∏–≥–∏–µ–Ω–∞ –∏ –∑–∞—â–∏—Ç–∞ –ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
              </li>
              <li data-href="lesson4.html">
                –£—Ä–æ–∫ 4. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä—ã: –ê–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ
              </li>
              <li data-href="lesson5.html">
                –£—Ä–æ–∫ 5. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä—ã: –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ
              </li>
              <li data-href="lesson6.html" class="active">–£—Ä–æ–∫ 6. –ê–ª–≥–æ—Ä–∏—Ç–º—ã</li>
            </ul>
          </div>

          <div class="content_games">
            <div class="final-engagement-survey">
              <div class="survey-header">
                <div class="survey-intro">
                  <h2>üéØ –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Ç–≤–æ–µ–≥–æ —É—á–∞—Å—Ç–∏—è!</h2>
                  <p>
                    –ü–æ—Å–ª–µ–¥–Ω–∏–π —ç—Ç–∞–ø - —Ä–∞—Å—Å–∫–∞–∂–∏ –æ —Å–≤–æ–µ–º —É—á–∞—Å—Ç–∏–∏ –≤ –∏–∑—É—á–µ–Ω–∏–∏
                    –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
                  </p>
                  <button id="startFinalSurvey" class="start-survey-btn">
                    –ó–∞–≤–µ—Ä—à–∏—Ç—å –æ—Ü–µ–Ω–∫—É
                  </button>
                </div>
              </div>

              <div
                id="finalSurveyContainer"
                class="survey-container"
                style="display: none"
              >
                <div class="survey-progress">
                  <div class="progress-bar">
                    <div class="progress-fill" id="surveyProgressFill"></div>
                  </div>
                  <p>
                    –í–æ–ø—Ä–æ—Å <span id="currentSurveyQ">1</span> –∏–∑
                    <span id="totalSurveyQ">5</span>
                  </p>
                </div>

                <div id="surveyQuestionContainer" class="question-container">
                  <!-- –í–æ–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                </div>

                <div
                  id="finalSurveyResult"
                  class="survey-result"
                  style="display: none"
                >
                  <h3 id="surveyResultTitle">–ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω! üéì</h3>
                  <p id="surveyResultText">–í–æ—Ç –∏—Ç–æ–≥–∏ —Ç–≤–æ–µ–≥–æ —É—á–∞—Å—Ç–∏—è –≤ –∫—É—Ä—Å–µ</p>
                  <div
                    id="engagementInsights"
                    class="engagement-insights"
                  ></div>
                  <div id="engagementLevel" class="engagement-level"></div>
                  <div id="courseCompletion" class="course-completion">
                    <h2>üèÜ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º —Å –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ–º –∫—É—Ä—Å–∞!</h2>
                    <p>
                      –¢—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–µ–ª –≤—Å–µ 6 —É—Ä–æ–∫–æ–≤ –ø–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–µ –¥–ª—è 5
                      –∫–ª–∞—Å—Å–∞!
                    </p>
                    <div class="final-achievements">
                      <h4>üéØ –¢–≤–æ–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:</h4>
                      <div class="achievement-grid">
                        <div class="achievement-item">
                          <div class="achievement-icon">üõ°Ô∏è</div>
                          <div class="achievement-text">
                            <h5>–ú–∞—Å—Ç–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</h5>
                            <p>–ò–∑—É—á–∏–ª –ø—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç—ã –≤ –∫–∞–±–∏–Ω–µ—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∏</p>
                          </div>
                        </div>
                        <div class="achievement-item">
                          <div class="achievement-icon">üßò‚Äç‚ôÄÔ∏è</div>
                          <div class="achievement-text">
                            <h5>–≠–∫—Å–ø–µ—Ä—Ç —ç—Ä–≥–æ–Ω–æ–º–∏–∫–∏</h5>
                            <p>–ü–æ–Ω—è–ª –≤–∞–∂–Ω–æ—Å—Ç—å –∑–¥–æ—Ä–æ–≤–æ–≥–æ —Ä–∞–±–æ—á–µ–≥–æ –º–µ—Å—Ç–∞</p>
                          </div>
                        </div>
                        <div class="achievement-item">
                          <div class="achievement-icon">üîí</div>
                          <div class="achievement-text">
                            <h5>–ó–∞—â–∏—Ç–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö</h5>
                            <p>–û—Å–≤–æ–∏–ª –æ—Å–Ω–æ–≤—ã –∫–∏–±–µ—Ä-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</p>
                          </div>
                        </div>
                        <div class="achievement-item">
                          <div class="achievement-icon">üîß</div>
                          <div class="achievement-text">
                            <h5>–ó–Ω–∞—Ç–æ–∫ –∂–µ–ª–µ–∑–∞</h5>
                            <p>–†–∞–∑–æ–±—Ä–∞–ª—Å—è —Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞</p>
                          </div>
                        </div>
                        <div class="achievement-item">
                          <div class="achievement-icon">üíª</div>
                          <div class="achievement-text">
                            <h5>–ú–∞—Å—Ç–µ—Ä –ü–û</h5>
                            <p>–ò–∑—É—á–∏–ª —Ç–∏–ø—ã –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è</p>
                          </div>
                        </div>
                        <div class="achievement-item">
                          <div class="achievement-icon">üß©</div>
                          <div class="achievement-text">
                            <h5>–ê–ª–≥–æ—Ä–∏—Ç–º–∏—Å—Ç</h5>
                            <p>–ü–æ–Ω—è–ª –æ—Å–Ω–æ–≤—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–æ–≥–æ –º—ã—à–ª–µ–Ω–∏—è</p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <button id="completeCourse" class="complete-course-btn">
                    üéâ –ó–∞–≤–µ—Ä—à–∏—Ç—å –∫—É—Ä—Å
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- –ö—Ä–∞—Å–∏–≤–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫—É—Ä—Å–∞ -->
    <div id="completionModal" class="completion-modal-overlay">
      <div class="completion-modal">
        <div class="completion-confetti">
          <div class="confetti"></div>
          <div class="confetti"></div>
          <div class="confetti"></div>
          <div class="confetti"></div>
          <div class="confetti"></div>
          <div class="confetti"></div>
          <div class="confetti"></div>
          <div class="confetti"></div>
          <div class="confetti"></div>
          <div class="confetti"></div>
        </div>

        <div class="completion-content">
          <div class="completion-trophy">üèÜ</div>
          <h2 class="completion-title">–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</h2>
          <p class="completion-subtitle">
            –¢—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–∏–ª –∫—É—Ä—Å –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∏ –¥–ª—è 5 –∫–ª–∞—Å—Å–∞!
          </p>

          <div class="completion-achievements">
            <h3>–¢–µ–ø–µ—Ä—å —Ç—ã –∑–Ω–∞–µ—à—å –æ—Å–Ω–æ–≤—ã:</h3>
            <div class="completion-skills">
              <div class="skill-item">
                <div class="skill-icon">üõ°Ô∏è</div>
                <span>–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ –∫–∞–±–∏–Ω–µ—Ç–µ</span>
              </div>
              <div class="skill-item">
                <div class="skill-icon">üßò‚Äç‚ôÄÔ∏è</div>
                <span>–≠—Ä–≥–æ–Ω–æ–º–∏–∫–∏</span>
              </div>
              <div class="skill-item">
                <div class="skill-icon">üîí</div>
                <span>–ö–∏–±–µ—Ä-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</span>
              </div>
              <div class="skill-item">
                <div class="skill-icon">üîß</div>
                <span>–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞</span>
              </div>
              <div class="skill-item">
                <div class="skill-icon">üíª</div>
                <span>–ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è</span>
              </div>
              <div class="skill-item">
                <div class="skill-icon">üß©</div>
                <span>–ê–ª–≥–æ—Ä–∏—Ç–º–æ–≤</span>
              </div>
            </div>
          </div>

          <div class="completion-message">
            <p>üöÄ –£–¥–∞—á–∏ –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –∏–∑—É—á–µ–Ω–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∏!</p>
          </div>

          <div class="completion-buttons">
            <button id="closeCompletion" class="completion-btn secondary">
              –ó–∞–∫—Ä—ã—Ç—å
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal for tooltips -->
    <div id="tooltipOverlay" class="tooltip-overlay"></div>
    <div id="tooltipModal" class="tooltip-modal"></div>

    <style>
      .final-engagement-survey {
        padding: 40px;
        background: linear-gradient(135deg, #f8f9fa, #e9ecef);
        border-radius: 20px;
        margin: 20px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
      }

      .survey-header {
        display: flex;
        gap: 30px;
        align-items: center;
        margin-bottom: 30px;
      }

      .survey-intro h2 {
        color: #4d36db;
        margin-bottom: 15px;
        font-size: 28px;
      }

      .survey-intro p {
        margin-bottom: 25px;
        font-size: 16px;
        color: #666;
      }

      .start-survey-btn {
        padding: 20px 40px;
        background: linear-gradient(135deg, #4d36db, #6b46c1);
        color: white;
        border: none;
        border-radius: 15px;
        font-size: 18px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: 'Montserrat', sans-serif;
        box-shadow: 0 4px 15px rgba(77, 54, 219, 0.3);
      }

      .start-survey-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(77, 54, 219, 0.4);
      }

      .survey-container {
        margin-top: 30px;
      }

      .survey-progress {
        margin-bottom: 30px;
        text-align: center;
      }

      .progress-bar {
        width: 100%;
        height: 8px;
        background-color: #e9ecef;
        border-radius: 4px;
        overflow: hidden;
        margin-bottom: 10px;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #4d36db, #6b46c1);
        transition: width 0.5s ease;
        width: 20%;
      }

      .question-container {
        background: white;
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }

      .question-title {
        color: #4d36db;
        font-size: 20px;
        font-weight: 600;
        margin-bottom: 20px;
      }

      .question-options {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .option-btn {
        padding: 15px 20px;
        background: #f8f9fa;
        border: 2px solid #dee2e6;
        border-radius: 10px;
        cursor: pointer;
        font-family: 'Montserrat', sans-serif;
        font-weight: 500;
        text-align: left;
        transition: all 0.3s ease;
        position: relative;
      }

      .option-btn:hover {
        background: #e9ecef;
        border-color: #4d36db;
        transform: translateX(5px);
      }

      .option-btn.selected {
        border-color: #4d36db;
        background: linear-gradient(135deg, #e8f0fe, #f3e5f5);
        transform: translateX(5px);
        box-shadow: 0 4px 12px rgba(77, 54, 219, 0.2);
      }

      .survey-result {
        background: linear-gradient(135deg, #d1ecf1, #bee5eb);
        border: 2px solid #17a2b8;
        padding: 30px;
        border-radius: 15px;
        text-align: center;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }

      .survey-result h3 {
        color: #0c5460;
        margin-bottom: 15px;
        font-size: 24px;
      }

      .survey-result p {
        color: #0c5460;
        margin-bottom: 20px;
        font-size: 16px;
      }

      .engagement-insights {
        background: rgba(255, 255, 255, 0.7);
        padding: 20px;
        border-radius: 10px;
        margin: 20px 0;
        text-align: left;
      }

      .insight-item {
        display: flex;
        align-items: center;
        margin: 10px 0;
        padding: 12px;
        background: white;
        border-radius: 8px;
        border-left: 4px solid #17a2b8;
      }

      .insight-emoji {
        font-size: 24px;
        margin-right: 15px;
      }

      .engagement-level {
        background: white;
        padding: 20px;
        border-radius: 10px;
        margin: 20px 0;
        border: 2px solid #17a2b8;
      }

      .level-indicator {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 15px;
        margin: 15px 0;
      }

      .level-bar {
        width: 200px;
        height: 20px;
        background: #e9ecef;
        border-radius: 10px;
        overflow: hidden;
        position: relative;
      }

      .level-fill {
        height: 100%;
        background: linear-gradient(90deg, #dc3545, #ffc107, #28a745);
        transition: width 0.8s ease;
        border-radius: 10px;
      }

      .level-text {
        font-weight: bold;
        font-size: 18px;
        color: #0c5460;
      }

      .course-completion {
        background: linear-gradient(135deg, #e8f5e8, #d4edda);
        padding: 30px;
        border-radius: 15px;
        margin: 25px 0;
        border: 3px solid #28a745;
      }

      .course-completion h2 {
        color: #155724;
        margin-bottom: 15px;
        font-size: 24px;
      }

      .course-completion p {
        color: #155724;
        font-size: 16px;
        margin-bottom: 20px;
      }

      .final-achievements h4 {
        color: #155724;
        margin-bottom: 20px;
        font-size: 18px;
      }

      .achievement-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 15px;
        margin-top: 20px;
      }

      .achievement-item {
        display: flex;
        align-items: center;
        background: rgba(255, 255, 255, 0.8);
        padding: 15px;
        border-radius: 10px;
        border-left: 4px solid #28a745;
      }

      .achievement-icon {
        font-size: 32px;
        margin-right: 15px;
        min-width: 50px;
      }

      .achievement-text h5 {
        color: #155724;
        margin-bottom: 5px;
        font-size: 14px;
        font-weight: 600;
      }

      .achievement-text p {
        color: #155724;
        font-size: 12px;
        margin: 0;
        line-height: 1.3;
      }

      .complete-course-btn {
        padding: 20px 40px;
        background: linear-gradient(135deg, #28a745, #20c997);
        color: white;
        border: none;
        border-radius: 15px;
        font-size: 18px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: 'Montserrat', sans-serif;
        box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
      }

      .complete-course-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
      }

      /* –ö—Ä–∞—Å–∏–≤–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è */
      .completion-modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(10px);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 10000;
        animation: fadeIn 0.5s ease;
      }

      .completion-modal-overlay.active {
        display: flex;
      }

      .completion-modal {
        position: relative;
        background: linear-gradient(135deg, #ffffff, #f8f9fa);
        border-radius: 25px;
        padding: 50px 40px;
        max-width: 600px;
        width: 90%;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        animation: modalSlideIn 0.6s ease;
        text-align: center;
        border: 3px solid #ffd700;
      }

      .completion-confetti {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        overflow: hidden;
        border-radius: 25px;
      }

      .confetti {
        position: absolute;
        width: 10px;
        height: 10px;
        background: linear-gradient(
          45deg,
          #ff6b6b,
          #4ecdc4,
          #45b7d1,
          #f9ca24,
          #f0932b
        );
        animation: confettiFall 3s linear infinite;
      }

      .confetti:nth-child(1) {
        left: 10%;
        animation-delay: 0s;
        background: #ff6b6b;
      }
      .confetti:nth-child(2) {
        left: 20%;
        animation-delay: 0.5s;
        background: #4ecdc4;
      }
      .confetti:nth-child(3) {
        left: 30%;
        animation-delay: 1s;
        background: #45b7d1;
      }
      .confetti:nth-child(4) {
        left: 40%;
        animation-delay: 1.5s;
        background: #f9ca24;
      }
      .confetti:nth-child(5) {
        left: 50%;
        animation-delay: 2s;
        background: #f0932b;
      }
      .confetti:nth-child(6) {
        left: 60%;
        animation-delay: 0.3s;
        background: #ff6b6b;
      }
      .confetti:nth-child(7) {
        left: 70%;
        animation-delay: 0.8s;
        background: #4ecdc4;
      }
      .confetti:nth-child(8) {
        left: 80%;
        animation-delay: 1.3s;
        background: #45b7d1;
      }
      .confetti:nth-child(9) {
        left: 90%;
        animation-delay: 1.8s;
        background: #f9ca24;
      }
      .confetti:nth-child(10) {
        left: 15%;
        animation-delay: 2.3s;
        background: #f0932b;
      }

      .completion-content {
        position: relative;
        z-index: 1;
      }

      .completion-trophy {
        font-size: 80px;
        margin-bottom: 20px;
        animation: bounce 2s infinite;
      }

      .completion-title {
        color: #2c3e50;
        font-size: 36px;
        font-weight: 800;
        margin-bottom: 15px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      }

      .completion-subtitle {
        color: #34495e;
        font-size: 18px;
        margin-bottom: 30px;
        font-weight: 500;
      }

      .completion-achievements {
        background: linear-gradient(135deg, #e8f5e8, #d4edda);
        border-radius: 15px;
        padding: 25px;
        margin: 25px 0;
        border: 2px solid #28a745;
      }

      .completion-achievements h3 {
        color: #155724;
        font-size: 20px;
        margin-bottom: 20px;
        font-weight: 600;
      }

      .completion-skills {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
      }

      .skill-item {
        display: flex;
        align-items: center;
        background: rgba(255, 255, 255, 0.8);
        padding: 12px 15px;
        border-radius: 10px;
        transition: transform 0.3s ease;
        border-left: 4px solid #28a745;
      }

      .skill-item:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      .skill-icon {
        font-size: 24px;
        margin-right: 12px;
      }

      .skill-item span {
        color: #155724;
        font-weight: 600;
        font-size: 14px;
      }

      .completion-message {
        background: linear-gradient(135deg, #fff3cd, #ffeaa7);
        border-radius: 15px;
        padding: 20px;
        margin: 25px 0;
        border: 2px solid #ffc107;
      }

      .completion-message p {
        color: #856404;
        font-size: 18px;
        font-weight: 600;
        margin: 0;
      }

      .completion-buttons {
        display: flex;
        gap: 15px;
        justify-content: center;
        flex-wrap: wrap;
        margin-top: 30px;
      }

      .completion-btn {
        padding: 15px 30px;
        border: none;
        border-radius: 12px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: 'Montserrat', sans-serif;
        min-width: 180px;
      }

      .completion-btn.primary {
        background: linear-gradient(135deg, #4d36db, #6b46c1);
        color: white;
        box-shadow: 0 4px 15px rgba(77, 54, 219, 0.3);
      }

      .completion-btn.primary:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(77, 54, 219, 0.4);
      }

      .completion-btn.secondary {
        background: linear-gradient(135deg, #6c757d, #868e96);
        color: white;
        box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
      }

      .completion-btn.secondary:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(108, 117, 125, 0.4);
      }

      /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes modalSlideIn {
        from {
          opacity: 0;
          transform: scale(0.7) translateY(-50px);
        }
        to {
          opacity: 1;
          transform: scale(1) translateY(0);
        }
      }

      @keyframes bounce {
        0%,
        20%,
        50%,
        80%,
        100% {
          transform: translateY(0);
        }
        40% {
          transform: translateY(-20px);
        }
        60% {
          transform: translateY(-10px);
        }
      }

      @keyframes confettiFall {
        0% {
          transform: translateY(-100vh) rotate(0deg);
          opacity: 1;
        }
        100% {
          transform: translateY(100vh) rotate(360deg);
          opacity: 0;
        }
      }

      @media (max-width: 768px) {
        .final-engagement-survey {
          padding: 20px;
          margin: 10px;
        }

        .survey-header {
          flex-direction: column;
          text-align: center;
          gap: 20px;
        }

        .survey-intro h2 {
          font-size: 24px;
        }

        .question-container {
          padding: 20px;
        }

        .achievement-grid {
          grid-template-columns: 1fr;
        }

        .level-bar {
          width: 150px;
        }

        .start-survey-btn,
        .complete-course-btn {
          padding: 15px 30px;
          font-size: 16px;
        }

        .completion-modal {
          padding: 30px 20px;
          margin: 20px;
        }

        .completion-title {
          font-size: 28px;
        }

        .completion-trophy {
          font-size: 60px;
        }

        .completion-skills {
          grid-template-columns: 1fr;
        }

        .completion-buttons {
          flex-direction: column;
          align-items: center;
        }

        .completion-btn {
          min-width: 200px;
        }
      }
    </style>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="js/slick.min.js"></script>
    <script src="js/jquery.fancybox.min.js"></script>
    <script src="js/help.js"></script>
    <script src="js/main.js"></script>

    <script>
      document.addEventListener('DOMContentLoaded', function () {
        
        if (window.TestResults) { try { window.TestResults.init({ lessonId: 6, requireAuth: true }); } catch(e) { console.warn(e); } }
const questions = [
          {
            question: '–ù–∞—Å–∫–æ–ª—å–∫–æ —Ç–µ–±–µ –±—ã–ª–æ –ª–µ–≥–∫–æ –∏–ª–∏ —Å–ª–æ–∂–Ω–æ –∏–∑—É—á–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º—ã?',
            type: 'difficulty',
            options: [
              { text: '–û—á–µ–Ω—å –ª–µ–≥–∫–æ', value: 'easy', class: 'easy' },
              {
                text: '–ù–µ–º–Ω–æ–≥–æ —Å–ª–æ–∂–Ω–æ, –Ω–æ —è —Å–ø—Ä–∞–≤–∏–ª—Å—è',
                value: 'medium',
                class: 'medium',
              },
              {
                text: '–û—á–µ–Ω—å —Å–ª–æ–∂–Ω–æ, –º–Ω–µ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å',
                value: 'hard',
                class: 'hard',
              },
            ],
          },
          {
            question:
              '–¢—ã —Å–∞–º –ø—Ä–æ–±–æ–≤–∞–ª —Å–æ–∑–¥–∞–≤–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∏–ª–∏ —Ç–æ–ª—å–∫–æ –∏–∑—É—á–∞–ª –ø—Ä–∏–º–µ—Ä—ã?',
            type: 'interaction',
            options: [
              {
                text: '–î–∞, —è –ø—Ä–æ–±–æ–≤–∞–ª —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã',
                value: 'high',
                class: 'high',
              },
              {
                text: '–ù–µ—Ç, –ø—Ä–æ—Å—Ç–æ –∏–∑—É—á–∞–ª –ø—Ä–∏–º–µ—Ä—ã',
                value: 'low',
                class: 'low',
              },
              { text: '–ò–Ω–æ–≥–¥–∞ –ø—Ä–æ–±–æ–≤–∞–ª', value: 'medium', class: 'medium' },
            ],
          },
          {
            question:
              '–¢—ã –±—ã —Ö–æ—Ç–µ–ª, —á—Ç–æ–±—ã –≤ –∫—É—Ä—Å–µ –±—ã–ª–æ –±–æ–ª—å—à–µ —É—Ä–æ–∫–æ–≤ –æ–± –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö?',
            type: 'preference',
            options: [
              { text: '–ë–æ–ª—å—à–µ', value: 'more', class: 'high' },
              { text: '–ú–µ–Ω—å—à–µ', value: 'less', class: 'low' },
              { text: '–°—Ç–æ–ª—å–∫–æ –∂–µ', value: 'same', class: 'medium' },
            ],
          },
          {
            question:
              '–ë—ã–ª–∏ –ª–∏ –º–æ–º–µ–Ω—Ç—ã, –∫–æ–≥–¥–∞ –∏–∑—É—á–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –ø–æ–∫–∞–∑–∞–ª–æ—Å—å —Å–∫—É—á–Ω—ã–º?',
            type: 'boredom',
            options: [
              {
                text: '–ù–µ—Ç, –±—ã–ª–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ',
                value: 'interesting',
                class: 'high',
              },
              {
                text: '–ë—ã–ª–æ —Å–∫—É—á–Ω–æ, –º–∞–ª–æ –ø—Ä–∞–∫—Ç–∏–∫–∏',
                value: 'few_tasks',
                class: 'low',
              },
              { text: '–°–ª–∏—à–∫–æ–º –ø—Ä–æ—Å—Ç–æ', value: 'too_easy', class: 'medium' },
            ],
          },
          {
            question:
              '–¢—ã –±—ã –º–æ–≥ –æ–±—ä—è—Å–Ω–∏—Ç—å –¥—Ä—É–≥—É, —á—Ç–æ —Ç–∞–∫–æ–µ –∞–ª–≥–æ—Ä–∏—Ç–º –∏ –∫–∞–∫ –µ–≥–æ —Å–æ–∑–¥–∞—Ç—å?',
            type: 'understanding',
            options: [
              { text: '–î–∞, –ª–µ–≥–∫–æ', value: 'confident', class: 'high' },
              { text: '–ù–∞–≤–µ—Ä–Ω–æ–µ, –¥–∞', value: 'maybe', class: 'medium' },
              { text: '–ù–µ —É–≤–µ—Ä–µ–Ω', value: 'unsure', class: 'low' },
            ],
          },
        ];

        let currentQuestion = 0;
        let answers = [];

        document
          .getElementById('startFinalSurvey')
          .addEventListener('click', startSurvey);

        // –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫—É—Ä—Å–∞
        document
          .getElementById('completeCourse')
          .addEventListener('click', showCompletionModal);

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        document
          .getElementById('closeCompletion')
          .addEventListener('click', hideCompletionModal);

        document
          .getElementById('downloadCertificate')
          .addEventListener('click', downloadCertificate);

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —Ñ–æ–Ω
        document
          .getElementById('completionModal')
          .addEventListener('click', function (e) {
            if (e.target === this) {
              hideCompletionModal();
            }
          });

        function startSurvey() {
          document.querySelector('.survey-header').style.display = 'none';
          document.getElementById('finalSurveyContainer').style.display =
            'block';
          document.getElementById('totalSurveyQ').textContent =
            questions.length;
          showQuestion();
        }

        function showQuestion() {
          const question = questions[currentQuestion];
          document.getElementById('currentSurveyQ').textContent =
            currentQuestion + 1;

          const progress = ((currentQuestion + 1) / questions.length) * 100;
          document.getElementById('surveyProgressFill').style.width =
            progress + '%';

          const container = document.getElementById('surveyQuestionContainer');

          container.innerHTML = `
            <div class="question-title">${question.question}</div>
            <div class="question-options">
              ${question.options
                .map(
                  (option, index) =>
                    `<button class="option-btn ${question.type}-option ${option.class}" data-index="${index}" data-value="${option.value}">
                  ${option.text}
                </button>`
                )
                .join('')}
            </div>
          `;

          container.querySelectorAll('.option-btn').forEach(btn => {
            btn.addEventListener('click', function () {
              container
                .querySelectorAll('.option-btn')
                .forEach(opt => opt.classList.remove('selected'));
              this.classList.add('selected');

              setTimeout(() => {
                selectAnswer(parseInt(this.dataset.index), this.dataset.value);
              }, 300);
            });
          });
        }

        function selectAnswer(selectedIndex, value) {
          const question = questions[currentQuestion];

          answers.push({
            question: question.question,
            selected: selectedIndex,
            answer: question.options[selectedIndex].text,
            value: value,
            type: question.type,
          });

          setTimeout(() => {
            currentQuestion++;
            if (currentQuestion < questions.length) {
              showQuestion();
            } else {
              showResults();
            }
          }, 500);
        }

        function showResults() {
          document.getElementById('surveyQuestionContainer').style.display =
            'none';
          const resultDiv = document.getElementById('finalSurveyResult');
          resultDiv.style.display = 'block';

          const engagementScore = calculateEngagementScore(answers);
          const insights = generateEngagementInsights(answers, engagementScore);

          const insightsDiv = document.getElementById('engagementInsights');
          insightsDiv.innerHTML =
            '<h4>üîç –ê–Ω–∞–ª–∏–∑ —Ç–≤–æ–µ–≥–æ —É—á–∞—Å—Ç–∏—è –≤ –∏–∑—É—á–µ–Ω–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤:</h4>' +
            insights
              .map(
                insight => `
              <div class="insight-item">
                <div class="insight-emoji">${insight.emoji}</div>
                <div>${insight.text}</div>
              </div>
            `
              )
              .join('');

          showEngagementLevel(engagementScore);
          // === –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–ª—è Excel (–ª–∏—Å—Ç "–í–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç—å") –∏ –∫–Ω–æ–ø–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è ===
          try {
            if (window.TestResults) {
              const exportQuestions = (typeof answers !== 'undefined' ? answers : []).map((a, i) => ({
                index: i + 1,
                question: a.question,
                answer: String(a.answer ?? a.value ?? ''),
                correct: true,
                correctAnswer: ''
              }));
              if (exportQuestions.length) {
                window.TestResults.saveTest({
                  testType: 'engagement',
                  questions: exportQuestions
                });
              }
              // –ö–Ω–æ–ø–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –ø–æ–¥ —É—Ä–æ–≤–Ω–µ–º –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç–∏
              window.TestResults.renderDownloadUI('#engagementLevel', { showDialogAfterSave: true, autoEnableWhenAllDone: true });
            }
          } catch (e) { console.warn('saveTest engagement failed', e); }

        }

        function calculateEngagementScore(answers) {
          let score = 0;
          const maxScore = 100;

          answers.forEach(answer => {
            switch (answer.value) {
              case 'easy':
              case 'high':
              case 'more':
              case 'interesting':
              case 'confident':
                score += 20;
                break;
              case 'medium':
              case 'same':
              case 'too_easy':
              case 'maybe':
                score += 12;
                break;
              case 'hard':
              case 'low':
              case 'less':
              case 'few_tasks':
              case 'unsure':
                score += 5;
                break;
            }
          });

          return Math.min(score, maxScore);
        }

        function generateEngagementInsights(answers, score) {
          const insights = [];

          // –ê–Ω–∞–ª–∏–∑ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
          const difficulty = answers[0]?.value;
          if (difficulty === 'easy') {
            insights.push({
              emoji: 'üß©',
              text: '–û—Ç–ª–∏—á–Ω–æ! –ê–ª–≥–æ—Ä–∏—Ç–º—ã –æ–∫–∞–∑–∞–ª–∏—Å—å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ –¥–ª—è —Ç–µ–±—è.',
            });
          } else if (difficulty === 'medium') {
            insights.push({
              emoji: 'üí™',
              text: '–•–æ—Ä–æ—à–æ! –¢—ã —Å–ø—Ä–∞–≤–∏–ª—Å—è —Å –∏–∑—É—á–µ–Ω–∏–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏.',
            });
          } else {
            insights.push({
              emoji: 'ü§ù',
              text: '–ê–ª–≥–æ—Ä–∏—Ç–º—ã - —Å–ª–æ–∂–Ω–∞—è —Ç–µ–º–∞. –ü—Ä–æ–¥–æ–ª–∂–∞–π –∏–∑—É—á–∞—Ç—å, –∏ —Å—Ç–∞–Ω–µ—Ç –ª–µ–≥—á–µ!',
            });
          }

          // –ê–Ω–∞–ª–∏–∑ –ø—Ä–∞–∫—Ç–∏–∫–∏
          const interaction = answers[1]?.value;
          if (interaction === 'high') {
            insights.push({
              emoji: 'üöÄ',
              text: '–ó–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–æ! –¢—ã –∞–∫—Ç–∏–≤–Ω–æ –ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞–ª—Å—è –≤ —Å–æ–∑–¥–∞–Ω–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤.',
            });
          } else if (interaction === 'medium') {
            insights.push({
              emoji: 'üëç',
              text: '–•–æ—Ä–æ—à–æ! –ü–æ–ø—Ä–æ–±—É–π —Å–æ–∑–¥–∞–≤–∞—Ç—å –±–æ–ª—å—à–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤.',
            });
          } else {
            insights.push({
              emoji: 'üí°',
              text: '–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –±–æ–ª—å—à–µ –ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å—Å—è –≤ —Å–æ–∑–¥–∞–Ω–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤!',
            });
          }

          // –ê–Ω–∞–ª–∏–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è
          const understanding = answers[4]?.value;
          if (understanding === 'confident') {
            insights.push({
              emoji: 'üéì',
              text: '–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ! –¢—ã —Ö–æ—Ä–æ—à–æ –ø–æ–Ω—è–ª —Ç–µ–º—É –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤.',
            });
          }

          // –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –∫—É—Ä—Å–∞
          insights.push({
            emoji: 'üèÜ',
            text: '–¢—ã –∑–∞–≤–µ—Ä—à–∏–ª –ø–æ–ª–Ω—ã–π –∫—É—Ä—Å –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∏ –¥–ª—è 5 –∫–ª–∞—Å—Å–∞! –≠—Ç–æ –±–æ–ª—å—à–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ!',
          });

          return insights;
        }

        function showEngagementLevel(score) {
          const levelDiv = document.getElementById('engagementLevel');
          let level, color, description;

          if (score >= 80) {
            level = '–û—Ç–ª–∏—á–Ω–∞—è –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å';
            color = '#28a745';
            description = '–¢—ã –∞–∫—Ç–∏–≤–Ω–æ —É—á–∞—Å—Ç–≤–æ–≤–∞–ª –≤ –∏–∑—É—á–µ–Ω–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤!';
          } else if (score >= 60) {
            level = '–•–æ—Ä–æ—à–∞—è –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å';
            color = '#ffc107';
            description = '–ù–µ–ø–ª–æ—Ö–æ–µ —É—á–∞—Å—Ç–∏–µ –≤ –∏–∑—É—á–µ–Ω–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤!';
          } else {
            level = '–ë–∞–∑–æ–≤–∞—è –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å';
            color = '#dc3545';
            description = '–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –±–æ–ª—å—à–µ –ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å—Å—è —Å –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏.';
          }

          levelDiv.innerHTML = `
            <h4>üìä –£—Ä–æ–≤–µ–Ω—å –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç–∏ –≤ –∏–∑—É—á–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤:</h4>
            <div class="level-indicator">
              <div class="level-bar">
                <div class="level-fill" style="width: ${score}%; background: ${color};"></div>
              </div>
              <div class="level-text">${score}%</div>
            </div>
            <p><strong>${level}</strong></p>
            <p>${description}</p>
          `;
        }

        function showCompletionModal() {
          const modal = document.getElementById('completionModal');
          modal.classList.add('active');
          document.body.style.overflow = 'hidden'; // –ë–ª–æ–∫–∏—Ä—É–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        }

        function hideCompletionModal() {
          const modal = document.getElementById('completionModal');
          modal.classList.remove('active');
          document.body.style.overflow = 'auto'; // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        }

        function downloadCertificate() {
          // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
          // –ü–æ–∫–∞ —á—Ç–æ –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
          alert(
            'üéâ –§—É–Ω–∫—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏!\n\n–í —Å–∫–æ—Ä–æ–º –≤—Ä–µ–º–µ–Ω–∏ —Ç—ã —Å–º–æ–∂–µ—à—å —Å–∫–∞—á–∞—Ç—å –∫—Ä–∞—Å–∏–≤—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–∏ –∫—É—Ä—Å–∞.'
          );
        }
      });
    </script>
  </body>
</html>
